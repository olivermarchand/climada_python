
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>BlackMarble class &#8212; climada 1.2.4-dev documentation</title>
    <link rel="stylesheet" href="../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
  </head><body>

<div style="background-color: white; text-align: left; padding: 10px 10px 15px 15px">
<a href="../index.html"><h1 style="font-size: 3em;">climada</h1></a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../index.html">home</a>|&nbsp;</li>
        <li><a href="../search.html">search</a>|&nbsp;</li>
 
      </ul>
    </div>

      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/tutorial/climada_entity_BlackMarble.ipynb.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 7ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<div class="section" id="BlackMarble-class">
<h1>BlackMarble class<a class="headerlink" href="#BlackMarble-class" title="Permalink to this headline">¶</a></h1>
<p>This class is used to approximate the economic exposure. It models countries and provinces interpolating the GDP and income group values through the night light intensities for a specific year.</p>
<p>The night light images used are the following: - year 2012 and 2016: <a class="reference external" href="https://earthobservatory.nasa.gov/Features/NightLights">https://earthobservatory.nasa.gov/Features/NightLights</a> (15 arcsec resolution (~500m)) - from 1992 until 2013: <a class="reference external" href="https://ngdc.noaa.gov/eog/dmsp/downloadV4composites.html">https://ngdc.noaa.gov/eog/dmsp/downloadV4composites.html</a> (30 arcsec resolution (~1km), stable lights)</p>
<p>By default, for years higher than 2013 the NASA images are used, whilst for 2013 and earlier years the NOAA ones are considered. However, there is a flag which allows to choose the closest NASA or NOAA images. The default resolution is that of the image, but any resolution can be set and will be computed by interpolation.</p>
<p>Regarding the GDP (nominal GDP at current USD) and income group values, they are obtained from the <a class="reference external" href="https://data.worldbank.org">World Bank</a> using the <a class="reference external" href="https://pandas-datareader.readthedocs.io/en/latest/remote_data.html">pandas-datareader</a> API. If a value is missing, the value of the closest year is considered. When no values are provided from the World Bank, we use the <a class="reference external" href="https://www.naturalearthdata.com">Natural Earth</a> repository values.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">BlackMarble</span></code> class inherits from the <code class="docutils literal notranslate"><span class="pre">`Exposures</span></code> &lt;climada_entity_Exposures.ipynb#Exposures-class&gt;`__ class. It provides a <code class="docutils literal notranslate"><span class="pre">set_countries()</span></code> method which enables to model a country using different settings. The first time a night light image is used, it is downloaded and stored locally. This might take some time.</p>
<p>With the next commands, we can model Iran and Turkey in the years 1992 and 2013 with the default resolution of ~1km. Please take into account that the NOAA images need to be calibrated in order to perform proper comparision between years.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">from</span> <span class="nn">climada.entity</span> <span class="kn">import</span> <span class="n">BlackMarble</span>

<span class="n">irn_tur_1992</span> <span class="o">=</span> <span class="n">BlackMarble</span><span class="p">()</span>
<span class="n">irn_tur_1992</span><span class="o">.</span><span class="n">set_countries</span><span class="p">([</span><span class="s1">&#39;Iran&#39;</span><span class="p">,</span> <span class="s1">&#39;Turkey&#39;</span><span class="p">],</span> <span class="mi">1992</span><span class="p">,</span> <span class="n">res_km</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">irn_tur_1992</span><span class="o">.</span><span class="n">plot_hexbin</span><span class="p">(</span><span class="n">vmax</span><span class="o">=</span><span class="mf">1e7</span><span class="p">)</span>

<span class="n">irn_tur_2013</span> <span class="o">=</span> <span class="n">BlackMarble</span><span class="p">()</span>
<span class="n">irn_tur_2013</span><span class="o">.</span><span class="n">set_countries</span><span class="p">([</span><span class="s1">&#39;Iran&#39;</span><span class="p">,</span> <span class="s1">&#39;Turkey&#39;</span><span class="p">],</span> <span class="mi">2013</span><span class="p">,</span> <span class="n">res_km</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">irn_tur_2013</span><span class="o">.</span><span class="n">plot_hexbin</span><span class="p">(</span><span class="n">vmax</span><span class="o">=</span><span class="mf">1e7</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2019-03-29 18:07:06,308 - climada - DEBUG - Loading default config file: /Users/aznarsig/Documents/Python/climada_python/climada/conf/defaults.conf
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/Users/aznarsig/anaconda3/envs/climada_env/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2019-03-29 18:07:09,358 - climada.util.finance - INFO - GDP IRN 1993: 6.374e+10.
2019-03-29 18:07:09,428 - climada.util.finance - INFO - Income group IRN 1992: 2.
2019-03-29 18:07:09,895 - climada.util.finance - INFO - GDP TUR 1992: 1.585e+11.
2019-03-29 18:07:09,956 - climada.util.finance - INFO - Income group TUR 1992: 2.
2019-03-29 18:07:09,957 - climada.entity.exposures.black_marble - INFO - Nightlights from NOAA&#39;s earth observation group for year 1992.
2019-03-29 18:07:10,123 - climada.entity.exposures.black_marble - INFO - Processing country Iran.
2019-03-29 18:07:14,330 - climada.entity.exposures.black_marble - INFO - Generating resolution of approx 1.0 km.
2019-03-29 18:07:14,601 - climada.entity.exposures.black_marble - INFO - Processing country Turkey.
2019-03-29 18:07:16,601 - climada.entity.exposures.black_marble - INFO - Generating resolution of approx 1.0 km.
2019-03-29 18:07:35,734 - climada.util.finance - INFO - GDP IRN 2013: 4.674e+11.
2019-03-29 18:07:35,789 - climada.util.finance - INFO - Income group IRN 2013: 3.
2019-03-29 18:07:36,304 - climada.util.finance - INFO - GDP TUR 2013: 9.506e+11.
2019-03-29 18:07:36,355 - climada.util.finance - INFO - Income group TUR 2013: 3.
2019-03-29 18:07:36,356 - climada.entity.exposures.black_marble - INFO - Nightlights from NOAA&#39;s earth observation group for year 2013.
2019-03-29 18:07:36,539 - climada.entity.exposures.black_marble - INFO - Processing country Iran.
2019-03-29 18:07:40,182 - climada.entity.exposures.black_marble - INFO - Generating resolution of approx 1.0 km.
2019-03-29 18:07:40,398 - climada.entity.exposures.black_marble - INFO - Processing country Turkey.
2019-03-29 18:07:42,099 - climada.entity.exposures.black_marble - INFO - Generating resolution of approx 1.0 km.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>(&lt;Figure size 648x936 with 2 Axes&gt;,
 array([[&lt;cartopy.mpl.geoaxes.GeoAxesSubplot object at 0x1a21f28a20&gt;]],
       dtype=object))
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_climada_entity_BlackMarble_2_4.png" src="../_images/tutorial_climada_entity_BlackMarble_2_4.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_climada_entity_BlackMarble_2_5.png" src="../_images/tutorial_climada_entity_BlackMarble_2_5.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">irn_tur_1992</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">size</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>3417059
</pre></div>
</div>
</div>
<p>Higher resolution is obtained by interpolating the night lights. If the resolution (parameter <code class="docutils literal notranslate"><span class="pre">res_km</span></code>) is not provided, the resolution of the nightlight images is going to be used.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">che</span> <span class="o">=</span> <span class="n">BlackMarble</span><span class="p">()</span>
<span class="n">che</span><span class="o">.</span><span class="n">set_countries</span><span class="p">([</span><span class="s1">&#39;Switzerland&#39;</span><span class="p">],</span> <span class="mi">2013</span><span class="p">,</span> <span class="n">res_km</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">che</span><span class="o">.</span><span class="n">plot_hexbin</span><span class="p">()</span>

<span class="c1"># use the NASA files (only available for 2012 and 2016) to interpolate from higher resolution</span>
<span class="n">che</span> <span class="o">=</span> <span class="n">BlackMarble</span><span class="p">()</span>
<span class="n">che</span><span class="o">.</span><span class="n">set_countries</span><span class="p">([</span><span class="s1">&#39;Switzerland&#39;</span><span class="p">],</span> <span class="mi">2013</span><span class="p">,</span> <span class="n">res_km</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">from_hr</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">che</span><span class="o">.</span><span class="n">plot_hexbin</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2019-03-29 18:08:51,287 - climada.util.finance - INFO - GDP CHE 2013: 6.885e+11.
2019-03-29 18:08:51,354 - climada.util.finance - INFO - Income group CHE 2013: 4.
2019-03-29 18:08:51,355 - climada.entity.exposures.black_marble - INFO - Nightlights from NOAA&#39;s earth observation group for year 2013.
2019-03-29 18:08:51,533 - climada.entity.exposures.black_marble - INFO - Processing country Switzerland.
2019-03-29 18:08:51,653 - climada.entity.exposures.black_marble - INFO - Generating resolution of approx 0.3 km.
2019-03-29 18:09:03,707 - climada.util.finance - INFO - GDP CHE 2013: 6.885e+11.
2019-03-29 18:09:03,758 - climada.util.finance - INFO - Income group CHE 2013: 4.
2019-03-29 18:09:03,759 - climada.entity.exposures.black_marble - INFO - Nightlights from NASA&#39;s earth observatory for year 2012.
2019-03-29 18:09:14,549 - climada.entity.exposures.black_marble - INFO - Processing country Switzerland.
2019-03-29 18:09:15,033 - climada.entity.exposures.black_marble - INFO - Generating resolution of approx 0.3 km.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>(&lt;Figure size 648x936 with 2 Axes&gt;,
 array([[&lt;cartopy.mpl.geoaxes.GeoAxesSubplot object at 0x1a2520c908&gt;]],
       dtype=object))
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_climada_entity_BlackMarble_5_2.png" src="../_images/tutorial_climada_entity_BlackMarble_5_2.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_climada_entity_BlackMarble_5_3.png" src="../_images/tutorial_climada_entity_BlackMarble_5_3.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">chn</span> <span class="o">=</span> <span class="n">BlackMarble</span><span class="p">()</span>
<span class="n">chn</span><span class="o">.</span><span class="n">set_countries</span><span class="p">([</span><span class="s1">&#39;China&#39;</span><span class="p">],</span> <span class="mi">2013</span><span class="p">,</span> <span class="n">res_km</span><span class="o">=</span><span class="mf">5.0</span><span class="p">)</span>
<span class="n">chn</span><span class="o">.</span><span class="n">plot_hexbin</span><span class="p">(</span><span class="n">vmax</span><span class="o">=</span><span class="mf">5e8</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2019-03-29 18:09:51,545 - climada.util.finance - INFO - GDP CHN 2013: 9.607e+12.
2019-03-29 18:09:51,608 - climada.util.finance - INFO - Income group CHN 2013: 3.
2019-03-29 18:09:51,609 - climada.entity.exposures.black_marble - INFO - Nightlights from NOAA&#39;s earth observation group for year 2013.
2019-03-29 18:09:51,768 - climada.entity.exposures.black_marble - INFO - Processing country China.
2019-03-29 18:10:20,856 - climada.entity.exposures.black_marble - INFO - Generating resolution of approx 5.0 km.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>(&lt;Figure size 648x936 with 2 Axes&gt;,
 array([[&lt;cartopy.mpl.geoaxes.GeoAxesSubplot object at 0x1a219dbfd0&gt;]],
       dtype=object))
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_climada_entity_BlackMarble_6_2.png" src="../_images/tutorial_climada_entity_BlackMarble_6_2.png" />
</div>
</div>
<p>Sea points can be added with the desired resolution. Their value will be 0.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">aus</span> <span class="o">=</span> <span class="n">BlackMarble</span><span class="p">()</span>
<span class="n">aus</span><span class="o">.</span><span class="n">set_countries</span><span class="p">([</span><span class="s1">&#39;Australia&#39;</span><span class="p">],</span> <span class="mi">2013</span><span class="p">,</span> <span class="n">res_km</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">sea_res</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">colors</span>
<span class="n">norm</span><span class="o">=</span><span class="n">colors</span><span class="o">.</span><span class="n">LogNorm</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="mf">1.0e4</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">1.0e9</span><span class="p">)</span>
<span class="n">aus</span><span class="o">.</span><span class="n">plot_hexbin</span><span class="p">(</span><span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2019-03-29 18:10:41,858 - climada.util.finance - INFO - GDP AUS 2013: 1.574e+12.
2019-03-29 18:10:41,906 - climada.util.finance - INFO - Income group AUS 2013: 4.
2019-03-29 18:10:41,906 - climada.entity.exposures.black_marble - INFO - Nightlights from NOAA&#39;s earth observation group for year 2013.
2019-03-29 18:10:42,045 - climada.entity.exposures.black_marble - INFO - Processing country Australia.
2019-03-29 18:10:58,935 - climada.entity.exposures.black_marble - INFO - Generating resolution of approx 2.0 km.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>(&lt;Figure size 648x936 with 2 Axes&gt;,
 array([[&lt;cartopy.mpl.geoaxes.GeoAxesSubplot object at 0x1a242fdba8&gt;]],
       dtype=object))
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_climada_entity_BlackMarble_8_2.png" src="../_images/tutorial_climada_entity_BlackMarble_8_2.png" />
</div>
</div>
<p>If you don’t write the country name right, the error log will provide you with possible similar options.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">hkg</span> <span class="o">=</span> <span class="n">BlackMarble</span><span class="p">()</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">hkg</span><span class="o">.</span><span class="n">set_countries</span><span class="p">([</span><span class="s1">&#39;Hong Kong&#39;</span><span class="p">],</span> <span class="mi">2016</span><span class="p">,</span> <span class="n">res_km</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Error caught.&#39;</span><span class="p">)</span>
    <span class="n">hkg</span><span class="o">.</span><span class="n">set_countries</span><span class="p">([</span><span class="s1">&#39;Hong Kong S.A.R.&#39;</span><span class="p">],</span> <span class="mi">2016</span><span class="p">,</span> <span class="n">res_km</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
    <span class="n">hkg</span><span class="o">.</span><span class="n">plot_hexbin</span><span class="p">(</span><span class="n">gridsize</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2019-03-29 18:11:44,635 - climada.entity.exposures.black_marble - ERROR - Country Hong Kong not found. Possible options: [&#39;Hong Kong S.A.R.&#39;]
Error caught.
2019-03-29 18:11:47,077 - climada.util.finance - INFO - GDP HKG 2016: 3.209e+11.
2019-03-29 18:11:47,128 - climada.util.finance - INFO - Income group HKG 2016: 4.
2019-03-29 18:11:47,129 - climada.entity.exposures.black_marble - INFO - Nightlights from NASA&#39;s earth observatory for year 2016.
2019-03-29 18:11:54,431 - climada.entity.exposures.black_marble - INFO - Processing country Hong Kong S.A.R..
2019-03-29 18:11:54,448 - climada.entity.exposures.black_marble - INFO - Generating resolution of approx 0.2 km.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/Users/aznarsig/anaconda3/envs/climada_env/lib/python3.6/site-packages/scipy/ndimage/interpolation.py:583: UserWarning: From scipy 0.13.0, the output shape of zoom() is calculated with round() instead of int() - for these inputs the size of the returned array has changed.
  &#34;the returned array has changed.&#34;, UserWarning)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_climada_entity_BlackMarble_10_2.png" src="../_images/tutorial_climada_entity_BlackMarble_10_2.png" />
</div>
</div>
<p>The GDP and income group can be given as inputs. Void values will indicate that the ones computed by Black Marble are used.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">au</span> <span class="o">=</span> <span class="n">BlackMarble</span><span class="p">()</span>
<span class="n">au</span><span class="o">.</span><span class="n">set_countries</span><span class="p">([</span><span class="s1">&#39;Argentina&#39;</span><span class="p">,</span> <span class="s1">&#39;Uruguay&#39;</span><span class="p">],</span> <span class="mi">2013</span><span class="p">,</span> <span class="n">res_km</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">gdp</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ARG&#39;</span><span class="p">:</span> <span class="mf">5e11</span><span class="p">,</span> <span class="s1">&#39;URY&#39;</span><span class="p">:</span> <span class="mf">5e10</span><span class="p">},</span> <span class="n">inc_grp</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ARG&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;URY&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">})</span>
<span class="n">norm</span><span class="o">=</span><span class="n">colors</span><span class="o">.</span><span class="n">LogNorm</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="mf">1.0e5</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">1.0e8</span><span class="p">)</span>
<span class="n">au</span><span class="o">.</span><span class="n">plot_hexbin</span><span class="p">(</span><span class="n">pop_name</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2019-03-29 18:11:58,194 - climada.entity.exposures.black_marble - INFO - Nightlights from NOAA&#39;s earth observation group for year 2013.
2019-03-29 18:11:58,375 - climada.entity.exposures.black_marble - INFO - Processing country Argentina.
2019-03-29 18:12:06,153 - climada.entity.exposures.black_marble - INFO - Generating resolution of approx 1.0 km.
2019-03-29 18:12:06,584 - climada.entity.exposures.black_marble - INFO - Processing country Uruguay.
2019-03-29 18:12:06,945 - climada.entity.exposures.black_marble - INFO - Generating resolution of approx 1.0 km.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>(&lt;Figure size 648x936 with 2 Axes&gt;,
 array([[&lt;cartopy.mpl.geoaxes.GeoAxesSubplot object at 0x1a2da61eb8&gt;]],
       dtype=object))
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_climada_entity_BlackMarble_12_2.png" src="../_images/tutorial_climada_entity_BlackMarble_12_2.png" />
</div>
</div>
<p>Finally, also provinces can be modelled using the country data as follows:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">country_name</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Germany&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Berlin&#39;</span><span class="p">,</span> <span class="s1">&#39;Brandenburg&#39;</span><span class="p">,</span> <span class="s1">&#39;Bayern&#39;</span><span class="p">,</span> <span class="s1">&#39;Sachsen&#39;</span><span class="p">,</span> <span class="s1">&#39;Thüringen&#39;</span><span class="p">,</span> <span class="s1">&#39;Sachsen-Anhalt&#39;</span><span class="p">],</span>
                <span class="s1">&#39;Czechia&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Prague&#39;</span><span class="p">,</span> <span class="s1">&#39;Karlovarský&#39;</span><span class="p">,</span> <span class="s1">&#39;Ústecký&#39;</span><span class="p">,</span> <span class="s1">&#39;Liberecký&#39;</span><span class="p">,</span> <span class="s1">&#39;Středočeský&#39;</span><span class="p">,</span> <span class="s1">&#39;Plzeňský&#39;</span><span class="p">,</span> <span class="s1">&#39;Jihočeský&#39;</span><span class="p">]}</span>

<span class="n">ent</span> <span class="o">=</span> <span class="n">BlackMarble</span><span class="p">()</span>
<span class="n">ent</span><span class="o">.</span><span class="n">set_countries</span><span class="p">(</span><span class="n">country_name</span><span class="p">,</span> <span class="mi">2012</span><span class="p">,</span> <span class="n">res_km</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">from_hr</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">colors</span>
<span class="n">norm</span><span class="o">=</span><span class="n">colors</span><span class="o">.</span><span class="n">LogNorm</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="mf">1.0e6</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">5.0e9</span><span class="p">)</span>
<span class="n">ent</span><span class="o">.</span><span class="n">plot_hexbin</span><span class="p">(</span><span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2019-03-29 18:13:00,131 - climada.util.finance - INFO - GDP DEU 2012: 3.544e+12.
2019-03-29 18:13:00,182 - climada.util.finance - INFO - Income group DEU 2012: 4.
2019-03-29 18:13:00,942 - climada.util.finance - INFO - GDP CZE 2012: 2.074e+11.
2019-03-29 18:13:00,993 - climada.util.finance - INFO - Income group CZE 2012: 4.
2019-03-29 18:13:00,994 - climada.entity.exposures.black_marble - INFO - Nightlights from NASA&#39;s earth observatory for year 2012.
2019-03-29 18:13:12,699 - climada.entity.exposures.black_marble - INFO - Processing country Germany.
2019-03-29 18:13:16,656 - climada.entity.exposures.black_marble - INFO - Generating resolution of approx 1.0 km.
2019-03-29 18:13:17,250 - climada.entity.exposures.black_marble - INFO - Processing country Czechia.
2019-03-29 18:13:18,140 - climada.entity.exposures.black_marble - INFO - Generating resolution of approx 1.0 km.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>(&lt;Figure size 648x936 with 2 Axes&gt;,
 array([[&lt;cartopy.mpl.geoaxes.GeoAxesSubplot object at 0x1a31c0cb00&gt;]],
       dtype=object))
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_climada_entity_BlackMarble_14_2.png" src="../_images/tutorial_climada_entity_BlackMarble_14_2.png" />
</div>
</div>
<p>Countries with oversea territories might take longer to compute. The USA using 0.5km resolution might take longer… (10min approx)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">country_name</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;United States Of America&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Florida&#39;</span><span class="p">]}</span>

<span class="n">flr</span> <span class="o">=</span> <span class="n">BlackMarble</span><span class="p">()</span>
<span class="n">flr</span><span class="o">.</span><span class="n">set_countries</span><span class="p">(</span><span class="n">country_name</span><span class="p">,</span> <span class="mi">2017</span><span class="p">)</span>
<span class="n">flr</span><span class="o">.</span><span class="n">plot_hexbin</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;Number of points:&#39;</span><span class="p">,</span> <span class="n">flr</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2019-03-29 18:13:35,341 - climada.util.finance - INFO - GDP USA 2017: 1.939e+13.
2019-03-29 18:13:35,388 - climada.util.finance - INFO - Income group USA 2017: 4.
2019-03-29 18:13:35,389 - climada.entity.exposures.black_marble - INFO - Nightlights from NASA&#39;s earth observatory for year 2016.
2019-03-29 18:17:31,315 - climada.entity.exposures.black_marble - INFO - Processing country United States Of America.
2019-03-29 18:23:50,153 - climada.entity.exposures.black_marble - INFO - Generating resolution of approx 0.5 km.
Number of points: 4287405
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_climada_entity_BlackMarble_16_1.png" src="../_images/tutorial_climada_entity_BlackMarble_16_1.png" />
</div>
</div>
<p>The polynomial transformation used in the nightlight intensity can be also set through the parameter <code class="docutils literal notranslate"><span class="pre">poly_val</span></code>. The default transformation is x^2; not transforming the intensities has this result:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">country_name</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Germany&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Berlin&#39;</span><span class="p">,</span> <span class="s1">&#39;Brandenburg&#39;</span><span class="p">,</span> <span class="s1">&#39;Bayern&#39;</span><span class="p">,</span> <span class="s1">&#39;Sachsen&#39;</span><span class="p">,</span> <span class="s1">&#39;Thüringen&#39;</span><span class="p">,</span> <span class="s1">&#39;Sachsen-Anhalt&#39;</span><span class="p">],</span>
                <span class="s1">&#39;Czechia&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Prague&#39;</span><span class="p">,</span> <span class="s1">&#39;Karlovarský&#39;</span><span class="p">,</span> <span class="s1">&#39;Ústecký&#39;</span><span class="p">,</span> <span class="s1">&#39;Liberecký&#39;</span><span class="p">,</span> <span class="s1">&#39;Středočeský&#39;</span><span class="p">,</span> <span class="s1">&#39;Plzeňský&#39;</span><span class="p">,</span> <span class="s1">&#39;Jihočeský&#39;</span><span class="p">]}</span>

<span class="n">ent</span> <span class="o">=</span> <span class="n">BlackMarble</span><span class="p">()</span>
<span class="c1"># linear transformation</span>
<span class="n">ent</span><span class="o">.</span><span class="n">set_countries</span><span class="p">(</span><span class="n">country_name</span><span class="p">,</span> <span class="mi">2012</span><span class="p">,</span> <span class="n">res_km</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">from_hr</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">poly_val</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">colors</span>
<span class="n">norm</span><span class="o">=</span><span class="n">colors</span><span class="o">.</span><span class="n">LogNorm</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="mf">1.0e6</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">5.0e9</span><span class="p">)</span>
<span class="n">ent</span><span class="o">.</span><span class="n">plot_hexbin</span><span class="p">(</span><span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2019-03-29 18:24:17,832 - climada.util.finance - INFO - GDP DEU 2012: 3.544e+12.
2019-03-29 18:24:17,891 - climada.util.finance - INFO - Income group DEU 2012: 4.
2019-03-29 18:24:18,411 - climada.util.finance - INFO - GDP CZE 2012: 2.074e+11.
2019-03-29 18:24:18,460 - climada.util.finance - INFO - Income group CZE 2012: 4.
2019-03-29 18:24:18,460 - climada.entity.exposures.black_marble - INFO - Nightlights from NASA&#39;s earth observatory for year 2012.
2019-03-29 18:24:28,513 - climada.entity.exposures.black_marble - INFO - Processing country Germany.
2019-03-29 18:24:32,254 - climada.entity.exposures.black_marble - INFO - Generating resolution of approx 1.0 km.
2019-03-29 18:24:32,819 - climada.entity.exposures.black_marble - INFO - Processing country Czechia.
2019-03-29 18:24:33,730 - climada.entity.exposures.black_marble - INFO - Generating resolution of approx 1.0 km.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>(&lt;Figure size 648x936 with 2 Axes&gt;,
 array([[&lt;cartopy.mpl.geoaxes.GeoAxesSubplot object at 0x1a45d702b0&gt;]],
       dtype=object))
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_climada_entity_BlackMarble_18_2.png" src="../_images/tutorial_climada_entity_BlackMarble_18_2.png" />
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../index.html">home</a>|&nbsp;</li>
        <li><a href="../search.html">search</a>|&nbsp;</li>
 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, ETH Zurich.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.5.
    </div>
  </body>
</html>